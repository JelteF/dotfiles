#!/bin/fish

set -l beamer false

function beamer_connected
    xrandr -q | grep "DFP5 connected" > /dev/null
end

function activate_beamer
    set beamer true
    xrandr --output DFP5 --mode 1920x1080 --above DFP10
    /home/jelte/fun/hue/turn.py off
end

function deactivate_beamer
    set beamer true
    xrandr --output DFP5 --off
    /home/jelte/fun/hue/turn.py on > /dev/null
end

while true
    echo beamer is $beamer

    if begin test $beamer = false; and beamer_connected; end
        echo 'connecting beamer'
        activate_beamer
    end

    if begin test $beamer = true; and not beamer_connected; end
        echo 'disconnecting beamer'
        deactivate_beamer
    end
    sleep 1
end
